{% extends "base.html" %}
{% load static %}
{% block head %}
  <style>.testbar { display: none; }</style>
{% endblock %}
{% block title %}Результат — iqmetr{% endblock %}
{% block content %}
  <h1 class="page-title">Результат</h1>

  <section class="card stack-md">
    <div id="iq-result-metrics" data-count="{{ rows|length }}"></div>
    <p><strong>Учасник:</strong> {{ session.name }}, {{ session.age }} років</p>
    <p><strong>Підсумковий бал:</strong> {{ total }}</p>
    <p class="muted">Втрат фокуса вкладки: {{ session.meta.focus_loss|default:"0" }}</p>
  </section>

  <h2 class="section">Протокол</h2>
  <ol class="section">
    {% for row in rows %}
      <li>
        <article class="question">
          <div><strong>{{ row.q.text }}</strong></div>
          <div>
            {% if row.selected %}
              Ваша відповідь: “{{ row.selected.text }}” —
              {% if row.is_correct %}<span class="ok">правильно</span>{% else %}<span class="bad">помилка</span>{% endif %},
              бал: {{ row.score }}
            {% else %}
              <span class="bad">Не обрано</span>, бал: 0.00
            {% endif %}
          </div>
          <div class="muted">Правильна відповідь: “{{ row.correct_answer.text }}”</div>
          <div class="muted">Складність: {{ row.q.get_difficulty_display }} (вага {{ row.q.score }})</div>
        </article>
      </li>
    {% endfor %}
  </ol>

  <div class="section">
    <a class="btn secondary" href="{% url 'start' %}">Пройти ще раз</a>
  </div>
{% endblock %}
{% block scripts %}
  <script src="{% static 'js/result.js' %}"></script>
{% endblock %}
