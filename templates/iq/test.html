{% extends "base.html" %}
{% load static %}
{% block title %}Тест — iqmetr{% endblock %}
{% block content %}
  <h1>Тест</h1>

  <div id="iq-test"
       data-remaining="{{ remaining|default:0 }}"
       data-total="{{ total_questions }}"
       data-autosave="{% url 'autosave' session.uuid %}"></div>

  <form method="post" id="test-form">{% csrf_token %}
    {% for q in questions %}
      <div class="question" data-qid="{{ q.id }}">
        <strong>#{{ forloop.counter }}.</strong> {{ q.text }}
        <div class="answers">
          {% if q.ordered_answers %}
            {% for a in q.ordered_answers %}
              <label><input type="radio" name="answer_{{ q.id }}" value="{{ a.id }}"> {{ a.text }}</label>
            {% endfor %}
          {% else %}
            {% for a in q.answers.all %}
              <label><input type="radio" name="answer_{{ q.id }}" value="{{ a.id }}"> {{ a.text }}</label>
            {% endfor %}
          {% endif %}
        </div>
      </div>
    {% endfor %}

    <div style="display:flex; gap:10px; margin-top:16px;">
      <button class="btn" type="submit" name="finish_now" value="1">Завершити тест</button>
      <button class="btn secondary" type="submit">Зберегти проміжні відповіді</button>
    </div>
  </form>
  <p class="muted">Ви можете зберігати відповіді під час проходження. Після завершення результат буде підраховано.</p>
{% endblock %}
{% block scripts %}
  <script src="{% static 'js/test.js' %}"></script>
{% endblock %}
